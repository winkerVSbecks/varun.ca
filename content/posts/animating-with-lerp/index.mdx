---
title: Animating things with lerp
date: 2022-05-07
image: ../../assets/chromatic-noise.gif
---

import { LerpyRects } from './lerpy-rects';
import { MovementVis } from './movement-vis';

<LerpyRects />

<!-- Damp is the new lerp -->

<!-- https://twitter.com/onirenaud/status/1450469547111337990 -->

It all started with a tweet. Lerp's become an indispensable tool for me when it comes to creating animations. It works really well for animating values over time.

## The basic ingredients

hen you're working with a draw loop, you get three timing variables:

1. `deltaTime`: the time elapsed since the last frame
2. `time`: the time elapsed since the beginning of the draw loop
3. `playHead`: the time elapsed since the beginning of the draw loop, but normalized to the range `[0, 1]`

`playHead` works perfectly as the `t` parameter for `lerp` function. Here's an example of how you can use it to animate the x position of a circle:

```js
const xStart = width * 0.25;
const xEnd = width * 0.75;
const y = height * 0.5;

function draw({ playhead }) {
  // move the circle
  const x = lerp(xStart, xEnd, t);
  const y = lerp(yStart, yEnd, t);
  // Draw the circle
  circle(x, y, radius / 2, 'white');
}
```

## What is lerp?

Lerp is a function that interpolates between two values using the parameter `t`. Where `t` is expected to be between `[0, 1]` range. It's super handy for interpolating between colors or creating keyframed animations.

```js
function lerp(min, max, t) {
  return min * (1 - t) + max * t;
}
```

<MovementVis
  circles={[{ type: 'lerp', start: [0.2, 0.5], end: [0.8, 0.5] }]}
  height={0.3 * 1080}
  margin={20}
  trail
/>

## What is damp?

```js
function damp(a, b, lambda, deltaTime) {
  return lerp(a, b, 1 - Math.exp(-lambda * deltaTime));
}
```

```js
const x = width * 0.25;
const xEnd = width * 0.75;
const y = height * 0.5;

function draw({ deltaTime }) {
  x = damp(x, xEnd, 3, deltaTime);
  circle(x, y, radius / 2, 'white');
}
```

<MovementVis
  circles={[{ type: 'damp', start: [0.2, 0.5], end: [0.8, 0.5] }]}
  height={0.3 * 1080}
  margin={20}
  controls={['lambda']}
  trail
/>

The movement takes the same amount of time. The farther the destination is the faster the circle travels.

<MovementVis
  circles={[
    { type: 'damp', start: [0.2, 0.2], end: [0.8, 0.2] },
    { type: 'damp', start: [0.2, 0.4], end: [0.7, 0.4] },
    { type: 'damp', start: [0.2, 0.6], end: [0.6, 0.6] },
    { type: 'damp', start: [0.2, 0.8], end: [0.5, 0.8] },
  ]}
  controls={['motion']}
/>

## Spring

```js
let vx = 0;

vx = lerp(vx, (end[0] - x2) * 0.4, deltaTime * 24);
x2 += vx;
```

<MovementVis
  circles={[{ type: 'spring', start: [0.2, 0.5], end: [0.8, 0.5] }]}
  height={0.3 * 1080}
  margin={20}
  controls={['stiffness', 'damping']}
  trail
/>

## slerp

```js
const dot = ([ax, ay], [bx, by]) =>
  (ax * bx + ay * by) / (Math.hypot(ax, ay) * Math.hypot(bx, by));

function slerp(p0, p1, t) {
  const angle = Math.acos(dot(p0, p1));

  const factor1 = Math.sin(angle * (1 - t)) / Math.sin(angle);
  const factor2 = Math.sin(angle * t) / Math.sin(angle);

  return [p0[0] * factor1 + p1[0] * factor2, p0[1] * factor1 + p1[1] * factor2];
}
```

<MovementVis
  circles={[{ type: 'slerp', start: [0.2, 0.5], end: [0.8, 0.5] }]}
  height={0.3 * 1080}
  margin={20}
  trail
/>

---

<MovementVis circles={[{ type: 'spring', random: true }]} />

<MovementVis
  circles={[
    { type: 'lerp', start: [0.2, 0.2], end: [0.8, 0.2] },
    { type: 'damp', start: [0.2, 0.4], end: [0.8, 0.4] },
    { type: 'spring', start: [0.2, 0.6], end: [0.8, 0.6] },
    { type: 'slerp', start: [0.2, 0.8], end: [0.8, 0.8] },
  ]}
/>

## Bonus: Animating colors

TODO
